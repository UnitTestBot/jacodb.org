import CodeBlock from '../../components/CodeBlock';


### Environment

|           |                                                |
|-----------|------------------------------------------------|
| OS        | Windows 10 Pro                                 |
| Processor | 11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz |
| RAM       | 16,0 GB                                        |
| Disk      | SSD                                            |

Benchmark runs across different scopes of java bytecode with following meanings:
- runtime - only java runtime without any additional dependencies
- runtime + guava - java runtime with one jar for guava
- runtime + project classpath - java runtime with all visible dependencies of `JacoDB` project
- runtime + Idea community - java runtime with all visible dependencies of `IDEA community` project

`JacoDB` benchmarks also include scheme when `Usages` feature is installed

### JacoDB

<CodeBlock codeText={`
    ./gradlew jcdbBenchmark
`}/>


| Benchmark                                                                                                                                                                     | Repeats  | Avg time per operation  |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|-------------------------|
| [runtime](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L36)                                   | 5        | 1064 ms                  |
| [runtime + guava](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L76)                           | 5        | 1090 ms                  |
| [runtime + project dependencies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L55)            | 5        | 1551 ms                 |
| [runtime + IDEA community dependecies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L97)      | 5        | 9054 ms                 |
| [runtime + Usages](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L45)                          | 5        | 1790 ms                  |
| [runtime + guava + Usages](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L86)                  | 5        | 2590 ms                  |
| [runtime + project dependencies + Usages](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L65)   | 5        | 2915 ms                 |
| [runtime + IDEA community + Usages](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L114)        | 5        | 9798 ms                 |

### Soot

Run
<CodeBlock codeText={`
./gradlew sootBenchmark
`}/>

| Benchmark                                                                                                                                                                | Repeats  | Avg time per operation |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|------------------------|
| [runtime](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L61)                              | 5        | 20985 ms               |
| [runtime + guava](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L66)                      | 5        | 23323 ms               |
| [runtime + project dependencies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L71)       | 5        | 24027 ms               |
| [runtime + IDEA community dependecies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L76) | 5        | 30286 ms               |

### SootUp

Runs with `createInDemandView`
<CodeBlock codeText={`
./gradlew sootupBenchmark
`}/>

| Benchmark                                                                                                                                                                    | Repeats  | Avg time per operation|
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|-----------------------|
| [runtime](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L39)                                  | 5        | 0.23 ms               |
| [runtime + guava](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L44)                        | 5        | 1 ms                  |
| [runtime + project dependencies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L49)         | 5        | 60 ms                 |
| [runtime + IDEA community dependecies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L54)   | 5        | 167                   |

Runs with `createFullView` consumed almost all of 16Gb RAM memory (failed with OOM on 12Gb).

| Benchmark                                                                                                                                                                    | Repeats  | Avg time per operation    |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------------------------|
| [runtime](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L39)                                  | 5        | 0.23 ms                   |
| [runtime + guava](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L44)                        | 5        | 89 ms                     |
| [runtime + project dependencies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L49)         | 5        | 4247 ms                   |
| [runtime + IDEA community dependecies](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L54)   | 5        | 114 723 ms (fails on 12Gb)|



### Comparison and differences

##### Soot
Soot just read all jar files and stores bytecode in memory. Jcdb works in a bit different way. Jcdb read available .class from jars and build folders in a parallel and as a result
is faster in a situation when there are a lot of jar files (because of parallel execution). Keep in mind that Jcdb has a huge job processed
in a background while almost all api is ready (hierarchy and usages requires background activity to be finished).

##### SootUp

SootUp just ignores runtime libraries. That describes that startup time with only runtime consumes almost zero time. Bigger projects produces much slower results.

##### JacoDB

JacoDB do some jobs in background while almost all api is usable. Here are results for background activities without `Usages` feature:

<CodeBlock codeText={`
    ./gradlew awaitBackgroundBenchmark
`}/>


| Benchmark                                                                                                                                                                                                          | Repeats  | Avg time per operation |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|------------------------|
| [runtime: wait for background jobs](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbAwaitBackgroundBenchmarks.kt#L59)                               | 5        | 3182 ms                |
| [runtime + project dependencies: wait for background jobs](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbAwaitBackgroundBenchmarks.kt#L72)        | 5        | 129849 ms              |
| [runtime + IDEA community dependencies: wait for background jobs](https://github.com/UnitTestBot/jacodb/tree/main/jacodb-core/src/test/kotlin/org/jacodb/testing/performance/JcdbAwaitBackgroundBenchmarks.kt#L86) | 2        | 76734 ms               |

For `Idea Community` code base result sqlite database file size is ~3.5Gb




